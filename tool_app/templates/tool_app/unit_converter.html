{% extends 'base.html' %}

{% block title %}Unit Converter - Toolbox{% endblock %}

{% block description %}Convert between different units of measurement including length, weight, temperature, volume, area, and speed.{% endblock %}

{% block content %}
<div class="min-h-screen bg-gradient-to-br from-gray-50 to-gray-100 py-8">
    <div class="max-w-4xl mx-auto">
        <!-- Header -->
        <div class="text-center mb-8">
            <h1 class="text-3xl md:text-4xl font-bold text-gray-900 mb-4">
                üìè Unit Converter
            </h1>
            <p class="text-lg text-gray-600 max-w-2xl mx-auto">
                Convert between different units of measurement including length, weight, temperature, volume, area, and speed.
            </p>
        </div>

        <!-- Unit Converter Form -->
        <div class="bg-white rounded-xl shadow-lg p-6 mb-8">
            <form method="post" class="space-y-6" id="converter-form">
                {% csrf_token %}
                
                <!-- Conversion Type -->
                <div>
                    <label for="{{ form.conversion_type.id_for_label }}" class="block text-sm font-medium text-gray-700">
                        {{ form.conversion_type.label }}
                    </label>
                    {{ form.conversion_type }}
                    {% if form.conversion_type.errors %}
                        <div class="mt-1 text-sm text-red-600">
                            {{ form.conversion_type.errors|first }}
                        </div>
                    {% endif %}
                </div>

                <!-- Value to Convert -->
                <div>
                    <label for="{{ form.value.id_for_label }}" class="block text-sm font-medium text-gray-700">
                        {{ form.value.label }}
                    </label>
                    {{ form.value }}
                    {% if form.value.errors %}
                        <div class="mt-1 text-sm text-red-600">
                            {{ form.value.errors|first }}
                        </div>
                    {% endif %}
                </div>

                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <!-- From Unit -->
                    <div>
                        <label for="{{ form.from_unit.id_for_label }}" class="block text-sm font-medium text-gray-700">
                            {{ form.from_unit.label }}
                        </label>
                        <select name="from_unit" id="id_from_unit" class="mt-1 block w-full py-2 px-3 border border-gray-300 bg-white rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500">
                        </select>
                        {% if form.from_unit.errors %}
                            <div class="mt-1 text-sm text-red-600">
                                {{ form.from_unit.errors|first }}
                            </div>
                        {% endif %}
                    </div>

                    <!-- To Unit -->
                    <div>
                        <label for="{{ form.to_unit.id_for_label }}" class="block text-sm font-medium text-gray-700">
                            {{ form.to_unit.label }}
                        </label>
                        <select name="to_unit" id="id_to_unit" class="mt-1 block w-full py-2 px-3 border border-gray-300 bg-white rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500">
                        </select>
                        {% if form.to_unit.errors %}
                            <div class="mt-1 text-sm text-red-600">
                                {{ form.to_unit.errors|first }}
                            </div>
                        {% endif %}
                    </div>
                </div>

                <!-- Submit Button -->
                <div class="flex justify-center">
                    <button type="submit" 
                            class="bg-teal-600 hover:bg-teal-700 text-white font-bold py-3 px-8 rounded-lg transition-colors transform hover:scale-105">
                        üìè Convert Units
                    </button>
                </div>
            </form>
        </div>

        <!-- Results -->
        {% if conversion_result %}
        <div class="bg-white rounded-xl shadow-lg p-6">
            {% if conversion_result.success %}
                <h2 class="text-2xl font-bold text-gray-900 mb-6 text-center">‚úÖ Conversion Complete!</h2>
                
                <!-- Conversion Result -->
                <div class="bg-gradient-to-r from-teal-50 to-cyan-50 border border-teal-200 rounded-xl p-6 mb-6">
                    <div class="text-center">
                        <div class="text-3xl font-bold text-teal-800 mb-2">
                            {{ conversion_result.converted_value }}
                        </div>
                        <div class="text-lg text-teal-700">
                            {{ conversion_result.converted_unit }}
                        </div>
                    </div>
                </div>

                <!-- Conversion Details -->
                <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-6">
                    <div class="bg-gray-50 rounded-lg p-4 text-center">
                        <div class="text-sm text-gray-600">Original Value</div>
                        <div class="text-lg font-semibold text-gray-800">{{ conversion_result.original_value }} {{ conversion_result.original_unit }}</div>
                    </div>
                    <div class="bg-gray-50 rounded-lg p-4 text-center">
                        <div class="text-sm text-gray-600">Conversion Type</div>
                        <div class="text-lg font-semibold text-gray-800 capitalize">{{ conversion_result.conversion_type }}</div>
                    </div>
                    <div class="bg-gray-50 rounded-lg p-4 text-center">
                        <div class="text-sm text-gray-600">Formula</div>
                        <div class="text-sm font-mono text-gray-800">{{ conversion_result.formula }}</div>
                    </div>
                </div>

                <!-- Copy Result -->
                <div class="text-center">
                    <button onclick="copyResult()" 
                            class="bg-blue-600 hover:bg-blue-700 text-white font-medium py-2 px-6 rounded-lg transition-colors">
                        üìã Copy Result
                    </button>
                </div>

            {% else %}
                <!-- Error Message -->
                <h2 class="text-2xl font-bold text-red-900 mb-4 text-center">‚ùå Conversion Failed</h2>
                <div class="bg-red-50 border border-red-200 rounded-lg p-4">
                    <div class="text-red-800">
                        <p><strong>Error:</strong> {{ conversion_result.error }}</p>
                        <p class="mt-2"><strong>Conversion Type:</strong> {{ conversion_result.conversion_type|title }}</p>
                    </div>
                </div>
            {% endif %}
        </div>
        {% endif %}

        <!-- Supported Units Info -->
        <div class="bg-blue-50 border border-blue-200 rounded-xl p-6 mt-8">
            <h3 class="text-lg font-semibold text-blue-900 mb-3">üìê Supported Conversions</h3>
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 text-sm">
                <div class="text-blue-800">
                    <strong>Length/Distance:</strong><br>
                    mm, cm, m, km, in, ft, yd, mi
                </div>
                <div class="text-blue-800">
                    <strong>Weight/Mass:</strong><br>
                    mg, g, kg, t, oz, lb, st
                </div>
                <div class="text-blue-800">
                    <strong>Temperature:</strong><br>
                    Celsius (C), Fahrenheit (F), Kelvin (K)
                </div>
                <div class="text-blue-800">
                    <strong>Volume:</strong><br>
                    ml, l, gal, qt, pt, cup, fl oz
                </div>
                <div class="text-blue-800">
                    <strong>Area:</strong><br>
                    mm¬≤, cm¬≤, m¬≤, km¬≤, in¬≤, ft¬≤, yd¬≤, acre
                </div>
                <div class="text-blue-800">
                    <strong>Speed:</strong><br>
                    m/s, km/h, mph, ft/s, knot
                </div>
            </div>
        </div>
    </div>
</div>

<script>
// Unit options for each conversion type
const unitOptions = {
    'length': [
        {value: 'mm', text: 'Millimeter (mm)'},
        {value: 'cm', text: 'Centimeter (cm)'},
        {value: 'm', text: 'Meter (m)'},
        {value: 'km', text: 'Kilometer (km)'},
        {value: 'in', text: 'Inch (in)'},
        {value: 'ft', text: 'Foot (ft)'},
        {value: 'yd', text: 'Yard (yd)'},
        {value: 'mi', text: 'Mile (mi)'}
    ],
    'weight': [
        {value: 'mg', text: 'Milligram (mg)'},
        {value: 'g', text: 'Gram (g)'},
        {value: 'kg', text: 'Kilogram (kg)'},
        {value: 't', text: 'Tonne (t)'},
        {value: 'oz', text: 'Ounce (oz)'},
        {value: 'lb', text: 'Pound (lb)'},
        {value: 'st', text: 'Stone (st)'}
    ],
    'temperature': [
        {value: 'C', text: 'Celsius (¬∞C)'},
        {value: 'F', text: 'Fahrenheit (¬∞F)'},
        {value: 'K', text: 'Kelvin (K)'}
    ],
    'volume': [
        {value: 'ml', text: 'Milliliter (ml)'},
        {value: 'l', text: 'Liter (l)'},
        {value: 'gal', text: 'Gallon (gal)'},
        {value: 'qt', text: 'Quart (qt)'},
        {value: 'pt', text: 'Pint (pt)'},
        {value: 'cup', text: 'Cup'},
        {value: 'fl oz', text: 'Fluid Ounce (fl oz)'}
    ],
    'area': [
        {value: 'mm¬≤', text: 'Square Millimeter (mm¬≤)'},
        {value: 'cm¬≤', text: 'Square Centimeter (cm¬≤)'},
        {value: 'm¬≤', text: 'Square Meter (m¬≤)'},
        {value: 'km¬≤', text: 'Square Kilometer (km¬≤)'},
        {value: 'in¬≤', text: 'Square Inch (in¬≤)'},
        {value: 'ft¬≤', text: 'Square Foot (ft¬≤)'},
        {value: 'yd¬≤', text: 'Square Yard (yd¬≤)'},
        {value: 'acre', text: 'Acre'}
    ],
    'speed': [
        {value: 'm/s', text: 'Meter per Second (m/s)'},
        {value: 'km/h', text: 'Kilometer per Hour (km/h)'},
        {value: 'mph', text: 'Mile per Hour (mph)'},
        {value: 'ft/s', text: 'Foot per Second (ft/s)'},
        {value: 'knot', text: 'Knot'}
    ]
};

// Update unit options when conversion type changes
document.addEventListener('DOMContentLoaded', function() {
    const conversionTypeSelect = document.getElementById('{{ form.conversion_type.id_for_label }}');
    const fromUnitSelect = document.getElementById('id_from_unit');
    const toUnitSelect = document.getElementById('id_to_unit');
    
    function updateUnitOptions() {
        const conversionType = conversionTypeSelect.value;
        const units = unitOptions[conversionType] || [];
        
        // Clear existing options
        fromUnitSelect.innerHTML = '';
        toUnitSelect.innerHTML = '';
        
        // Add new options
        units.forEach(unit => {
            fromUnitSelect.add(new Option(unit.text, unit.value));
            toUnitSelect.add(new Option(unit.text, unit.value));
        });
        
        // Set default selections
        if (units.length > 1) {
            toUnitSelect.selectedIndex = 1;
        }
    }
    
    // Update on page load and when conversion type changes
    updateUnitOptions();
    conversionTypeSelect.addEventListener('change', updateUnitOptions);
});

function copyResult() {
    {% if conversion_result and conversion_result.success %}
    const resultText = '{{ conversion_result.formula }}';
    
    navigator.clipboard.writeText(resultText).then(function() {
        // Show success message
        event.target.textContent = '‚úÖ Copied!';
        event.target.classList.add('bg-green-600');
        event.target.classList.remove('bg-blue-600');
        
        setTimeout(function() {
            event.target.textContent = 'üìã Copy Result';
            event.target.classList.remove('bg-green-600');
            event.target.classList.add('bg-blue-600');
        }, 2000);
    });
    {% endif %}
}
</script>
{% endblock %}